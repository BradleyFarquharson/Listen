<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Listen â€” Recording</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: transparent;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    .pill {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 16px 8px 12px;
      background: rgba(15, 15, 15, 0.88);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 100px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      animation: fadeIn 0.2s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Recording dot */
    .rec-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ef4444;
      animation: blink 1.5s ease-in-out infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    /* Waveform bars */
    .waveform {
      display: flex;
      align-items: center;
      gap: 2px;
      height: 20px;
    }

    .waveform .bar {
      width: 3px;
      border-radius: 2px;
      background: #ef4444;
      animation: wave 0.8s ease-in-out infinite;
    }

    .bar:nth-child(1) { height: 6px;  animation-delay: 0s; }
    .bar:nth-child(2) { height: 12px; animation-delay: 0.1s; }
    .bar:nth-child(3) { height: 18px; animation-delay: 0.2s; }
    .bar:nth-child(4) { height: 10px; animation-delay: 0.3s; }
    .bar:nth-child(5) { height: 14px; animation-delay: 0.15s; }

    @keyframes wave {
      0%, 100% { transform: scaleY(0.4); }
      50%      { transform: scaleY(1); }
    }

    .label {
      font-size: 12px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.7);
      white-space: nowrap;
    }

    /* Listening mode (green) */
    .pill.listening .rec-dot {
      background: #22c55e;
    }
    .pill.listening .bar {
      background: #22c55e;
    }
  </style>
</head>
<body>
  <div class="pill" id="pill">
    <span class="rec-dot"></span>
    <div class="waveform">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <span class="label" id="label">Recording...</span>
  </div>

  <script>
    const { ipcRenderer } = require("electron");

    ipcRenderer.on("pill-update", (_event, data) => {
      const pill = document.getElementById("pill");
      const label = document.getElementById("label");

      pill.className = "pill";
      if (data.mode === "listening") {
        pill.classList.add("listening");
      }
      label.textContent = data.text || "Recording...";
    });
  </script>
</body>
</html>
